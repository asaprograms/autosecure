import json


def remove_exploit(client) -> bool:
    apicanary = client.cookies.get("apicanary")
    if not apicanary:
        return False
    payload = {
        "uiflvr": 1001,
        "uaid": "abd2ca2a346c43c198c9ca7e4255f3bc",
        "scid": 100109,
        "hpgid": 201030,
    }
    try:
        resp = client.post(
            "https://account.live.com/API/Proofs/RevokeWindowsHelloProofs",
            data=json.dumps(payload),
            headers={"canary": apicanary, "Content-Type": "application/json"},
        )
        return bool(resp.json().get("apiCanary"))
    except Exception:
        return False 